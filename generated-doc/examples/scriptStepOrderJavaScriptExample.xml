<?xml version="1.0" ?>
<!DOCTYPE source [<!ENTITY nbsp "&#160;">]>
<source>
&lt;<tag>webtest</tag>&nbsp;<att>name</att><val>scriptStep:&nbsp;test&nbsp;fictitious&nbsp;order&nbsp;page&nbsp;with&nbsp;inlined&nbsp;JavaScript&nbsp;script</val>&gt;<n/>
&amp;sharedConfiguration;<n/>
&lt;<tag>steps</tag>&gt;<n/>
&lt;<tag>invoke</tag>&nbsp;<att>description</att><val>Load&nbsp;Initial&nbsp;Page</val><n/>
&nbsp;<att>url</att><val>order.html</val>/&gt;<n/>
&lt;<tag>scriptStep</tag>&nbsp;<att>description</att><val>calculate&nbsp;qty&nbsp;and&nbsp;price</val>&nbsp;<att>language</att><val>javascript</val>&gt;<n/>
&nbsp;&nbsp;&nbsp;calc_qty&nbsp;=&nbsp;0;<n/>
&nbsp;&nbsp;&nbsp;calc_price&nbsp;=&nbsp;0;<n/>
&nbsp;&nbsp;&nbsp;items&nbsp;=&nbsp;document.getHtmlElementsByAttribute('tr',&nbsp;'class',&nbsp;'lineitem').iterator();<n/>
&nbsp;&nbsp;&nbsp;while&nbsp;(items.hasNext())&nbsp;{<n/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;table_cells&nbsp;=&nbsp;items.next().getHtmlElementsByTagName('td');<n/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;qty&nbsp;=&nbsp;parseInt(table_cells.get(1).asText());<n/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unit_price&nbsp;=&nbsp;parseInt(table_cells.get(2).asText());<n/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;total_line_price&nbsp;=&nbsp;parseInt(table_cells.get(3).asText());<n/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;calc_qty&nbsp;+=&nbsp;qty;<n/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;calc_price&nbsp;+=&nbsp;total_line_price;<n/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(qty&nbsp;*&nbsp;unit_price&nbsp;!=&nbsp;total_line_price)&nbsp;{<n/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;step.setWebtestProperty('calc_error_found',&nbsp;'true');<n/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<n/>
&nbsp;&nbsp;&nbsp;}<n/>
&nbsp;&nbsp;&nbsp;step.setWebtestProperty('calc_qty',&nbsp;calc_qty);<n/>
&nbsp;&nbsp;&nbsp;step.setWebtestProperty('calc_price',&nbsp;calc_price);<n/>
&lt;/<tag>scriptStep</tag>&gt;<n/>
&lt;<tag>not</tag>&gt;<n/>
&nbsp;&nbsp;&nbsp;&lt;<tag>verifyProperty</tag>&nbsp;<att>name</att><val>calc_error_found</val>&nbsp;<att>text</att><val>true</val>&nbsp;/&gt;<n/>
&lt;/<tag>not</tag>&gt;<n/>
&lt;<tag>verifyXPath</tag>&nbsp;<att>description</att><val>check&nbsp;total&nbsp;qty</val><n/>
&nbsp;&nbsp;&nbsp;<att>xpath</att><val>//tr[@class='total']/td[2]</val><n/>
&nbsp;&nbsp;&nbsp;<att>text</att><val>#{calc_qty}</val>/&gt;<n/>
&lt;<tag>verifyXPath</tag>&nbsp;<att>description</att><val>check&nbsp;total&nbsp;price</val><n/>
&nbsp;&nbsp;&nbsp;<att>xpath</att><val>//tr[@class='total']/td[4]</val><n/>
&nbsp;&nbsp;&nbsp;<att>text</att><val>#{calc_price}</val>/&gt;<n/>
&lt;/<tag>steps</tag>&gt;<n/>
&lt;/<tag>webtest</tag>&gt;<n/>
</source>
